<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Faith Quiz - Gamified</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Interactive Bible quiz with gamification to earn bonuses.">
<style>
  :root {
    --bg:#0f1222;
    --card:#1e2442;
    --accent:#d4af37;
    --text:#f5f5f8;
    --radius:14px;
    --transition:.25s;
    font-family: system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;
  }
  *{box-sizing:border-box;}
  body {
    margin:0;
    background: radial-gradient(circle at 30% 30%, #1e2442 0%, #0f1222 90%);
    color: var(--text);
    min-height:100vh;
    display:flex;
    justify-content:center;
    padding:1rem;
  }
  .app {
    width:100%;
    max-width:640px;
    background: var(--card);
    border-radius:16px;
    padding:1.75rem 2rem;
    position:relative;
    overflow:hidden;
    box-shadow:0 40px 90px -10px rgba(0,0,0,.7);
    border:2px solid rgba(212,175,55,.3);
  }
  h1 {
    margin:0;
    font-size:1.9rem;
    letter-spacing:1px;
    text-align:center;
    color: var(--accent);
  }
  .stage-label {
    display:inline-block;
    background: rgba(212,175,55,.1);
    padding:4px 12px;
    border-radius:999px;
    margin-bottom:6px;
    font-size:.65rem;
    text-transform:uppercase;
    font-weight:600;
  }
  .scoreboard {
    display:flex;
    gap:1rem;
    flex-wrap:wrap;
    margin:12px 0;
    justify-content: space-between;
  }
  .badge {
    background: rgba(255,255,255,.05);
    padding:.65rem 1rem;
    border-radius:8px;
    font-size:.85rem;
    display:flex;
    align-items:center;
    gap:.5rem;
    flex:1;
    min-width:140px;
  }
  .question-box {
    background: rgba(255,255,255,.03);
    border-radius:12px;
    padding:1rem 1rem 1.25rem;
    margin-top:8px;
    position:relative;
    border:1px solid rgba(255,255,255,.08);
  }
  .question {
    font-size:1.2rem;
    margin:0 0 .75rem 0;
  }
  .options {
    display:grid;
    gap:.75rem;
  }
  .option-btn {
    background:#1d2350;
    border:2px solid transparent;
    padding:.9rem 1rem;
    border-radius:8px;
    cursor:pointer;
    font-size:1rem;
    position: relative;
    transition: var(--transition);
    text-align:left;
    display:flex;
    align-items:center;
    gap:.6rem;
  }
  .option-btn:hover { transform:translateY(-2px); box-shadow:0 16px 50px -10px rgba(212,175,55,.4); }
  .option-btn.correct { border-color:#2ecc71; background: rgba(46,204,113,0.15); }
  .option-btn.wrong { border-color:#e74c3c; background: rgba(231,76,60,0.1); }
  .feedback {
    margin-top:10px;
    min-height:24px;
    font-weight:600;
  }
  .next-btn, .restart-btn {
    margin-top:1rem;
    padding:.85rem 1.2rem;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:700;
    background: var(--accent);
    color:#1a1a1a;
    font-size:1rem;
    transition: var(--transition);
  }
  .next-btn:disabled { opacity:.5; cursor:not-allowed; }
  .final {
    display:none;
    text-align:center;
    margin-top:8px;
  }
  .bonus-box {
    background: rgba(255,255,255,.04);
    padding:1rem 1rem 1.5rem;
    border-radius:10px;
    margin-top:12px;
    border:1px solid rgba(212,175,55,.2);
    text-align:left;
  }
  .highlight {
    background: rgba(46,204,113,0.12);
    padding:10px;
    border-radius:8px;
    font-weight:600;
    margin-bottom:8px;
  }
  .persuasion {
    background: linear-gradient(135deg,#fff8e1,#f3e0b5);
    padding:14px;
    border-radius:10px;
    margin-top:10px;
    color:#1f1f1f;
    font-weight:600;
  }
  .availability {
    background:#c0392b;
    padding:6px 14px;
    border-radius:6px;
    color:#fff;
    display:inline-block;
    font-size:.75rem;
    margin-left:4px;
  }
  .coin-display {
    display:flex;
    align-items:center;
    gap:.5rem;
    font-weight:600;
  }
  .coin-icon {
    width:18px;
    height:18px;
    border-radius:50%;
    background: radial-gradient(circle at 30% 30%, #ffe066,#f5b700);
    position:relative;
    flex-shrink:0;
  }
  .coin-icon::after {
    content:'ðŸª™';
    position:absolute;
    top:0; left:0;
    width:100%; height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:14px;
  }
  .link-btn {
    display:inline-block;
    margin-top:12px;
    padding:14px 22px;
    background:#176f47;
    color:#fff;
    border:none;
    border-radius:8px;
    cursor:pointer;
    font-weight:700;
    text-decoration:none;
    font-size:1rem;
    transition:.2s;
  }
  .link-btn:hover { filter:brightness(1.05); }
  .small { font-size:.65rem; color:rgba(255,255,255,.7); }
  .confetti { pointer-events:none; position:fixed; inset:0; z-index:999; overflow:hidden; }
  .confetto { position:absolute; width:7px; height:7px; border-radius:2px; mix-blend-mode:screen; }
</style>
</head>
<body>
  <div class="app" aria-label="Faith Quiz gamified">
    <div class="stage-label" id="stage-label">Stage 1 of 3</div>
    <h1>Faith Quiz</h1>
    <div class="scoreboard">
      <div class="badge">
        <div class="coin-display"><div class="coin-icon" aria-hidden="true"></div><div id="coin-count">0</div></div>
        <div>Coins</div>
      </div>
      <div class="badge">
        <div id="question-progress">Question 1 / 9</div>
      </div>
    </div>

    <div id="content"></div>

    <div class="final" id="final-screen">
      <h2>You've completed the quiz!</h2>
      <div class="highlight">
        Even if you missed some, <strong>you earned 3 guaranteed bonus coupons</strong> just for participating.
      </div>
      <p>You collected <strong><span id="final-coins">0</span> coins</strong>.</p>
      <div class="bonus-box">
        <p><strong>Conversion of coins into bonuses:</strong></p>
        <p id="bonus-detail"></p>
        <p>This gives access to the special Bible book and faith-strengthening techniques.</p>
        <div class="persuasion">
          <p>ðŸ”” <strong>Limited offer:</strong> Only <span class="availability">3 units available</span>. Act now to claim yours â€” time is running out.</p>
        </div>
        <a class="link-btn" id="product-link" href="https://buy.stripe.com/5kQ28q0z23mFgmrgfGaAw00" target="_blank">ðŸ‘‰ Access and Redeem (<span id="coupon-code">...</span>)</a>
      </div>
      <button class="restart-btn" id="restart">Restart Quiz</button>
      <div class="small" style="margin-top:10px; text-align:center;">
        Faith-based growth. Gamification to reinforce belief and momentum.
      </div>
    </div>
  </div>

  <div class="confetti" id="confetti-container"></div>

  <script>
    const stages = [
      { name:"Stage 1", questions:[
          { q:"How many disciples did Jesus originally choose?", options:["10","12","14","16"], correct:1, reward:5 },
          { q:"What is the first book of the Bible?", options:["Exodus","Genesis","Psalms","Isaiah"], correct:1, reward:5 },
          { q:"Who built the ark to survive the flood?", options:["Moses","Abraham","Noah","David"], correct:2, reward:5 }
      ]},
      { name:"Stage 2", questions:[
          { q:"What is one fruit of the Spirit mentioned in Galatians?", options:["Wealth","Love","Fame","Power"], correct:1, reward:10 },
          { q:"Who was thrown into the lions' den and survived?", options:["Daniel","Elijah","Samuel","Jonah"], correct:0, reward:10 },
          { q:"What was the name of the king famous for his wisdom?", options:["Saul","Solomon","Josiah","Rebekah"], correct:1, reward:10 }
      ]},
      { name:"Stage 3", questions:[
          { q:"Jesus multiplied how many loaves of bread to feed the crowd?", options:["2","5","7","10"], correct:1, reward:15 },
          { q:"What is the greatest commandment according to Jesus?", options:["Love God and your neighbor","Keep the Sabbath","Give tithes","Always fast"], correct:0, reward:15 },
          { q:"Who denied Jesus three times before the rooster crowed?", options:["Peter","Thomas","John","Judas"], correct:0, reward:15 }
      ]}
    ];

    let stageIndex=0, questionIndex=0, coins=0, answered=false;

    const coinCountEl = document.getElementById('coin-count');
    const contentEl = document.getElementById('content');

    function playSuccess() {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const now = ctx.currentTime;
        [500,650,800].forEach((f,i)=>{
          const osc = ctx.createOscillator();
          const gain = ctx.createGain();
          osc.type='triangle';
          osc.frequency.value=f;
          gain.gain.value=0.08*(1 - i*0.1);
          osc.connect(gain);
          gain.connect(ctx.destination);
          osc.start(now + i*0.04);
          osc.stop(now + i*0.04 + 0.18);
        });
      } catch(e){}
    }
    function playFail() {
      try {
        const ctx = new (window.AudioContext||window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type='sawtooth';
        osc.frequency.value=180;
        gain.gain.value=0.1;
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.start();
        setTimeout(()=>osc.stop(),180);
      } catch(e){}
    }

    function floatCoin(amount) {
      const el = document.createElement('div');
      el.textContent = `+${amount} ðŸª™`;
      el.style.position='fixed';
      el.style.left='50%';
      el.style.top='35%';
      el.style.transform='translate(-50%,-50%) scale(1)';
      el.style.padding='10px 18px';
      el.style.background='rgba(212,175,55,0.95)';
      el.style.color='#1a1a1a';
      el.style.fontWeight='700';
      el.style.borderRadius='999px';
      el.style.fontSize='1.2rem';
      el.style.zIndex=2000;
      el.style.transition='transform .7s ease-out, opacity .7s ease-out';
      document.body.appendChild(el);
      requestAnimationFrame(()=>{
        el.style.transform='translate(-50%,-180px) scale(1.3)';
        el.style.opacity='0';
      });
      setTimeout(()=>el.remove(),700);
      triggerConfetti();
    }

    function triggerConfetti() {
      const container = document.getElementById('confetti-container');
      for(let i=0;i<25;i++){
        const c=document.createElement('div');
        c.className='confetto';
        c.style.left=Math.random()*100+'%';
        c.style.top='-10px';
        const size=5 + Math.random()*8;
        c.style.width=size+'px';
        c.style.height=size+'px';
        const colors=['#d4af37','#ffffff','#2ecc71'];
        c.style.background=colors[Math.floor(Math.random()*colors.length)];
        container.appendChild(c);
        const endX=(Math.random()-0.5)*160;
        const endY=100 + Math.random()*60;
        const duration=1000 + Math.random()*600;
        c.animate([
          { transform:'translate(0,0) rotate(0deg)', opacity:1 },
          { transform:`translate(${endX}px, ${endY}px) rotate(${Math.random()*360}deg)`, opacity:0 }
        ], { duration, easing:'cubic-bezier(.25,.8,.5,1)' });
        setTimeout(()=>{ c.remove(); }, duration+100);
      }
    }

    function updateHeader() {
      const total = stages.reduce((sum,s)=>sum+s.questions.length,0);
      const global = stages.slice(0,stageIndex).reduce((sum,s)=>sum+s.questions.length,0) + questionIndex;
      document.getElementById('stage-label').textContent = `${stages[stageIndex].name} (${stageIndex+1} of ${stages.length})`;
      document.getElementById('question-progress').textContent = `Question ${global+1} / ${total}`;
      coinCountEl.textContent = coins;
    }

    function showQuestion() {
      answered=false;
      contentEl.innerHTML='';
      if(stageIndex >= stages.length){
        return finish();
      }
      const stage = stages[stageIndex];
      if(questionIndex >= stage.questions.length){
        stageIndex++; questionIndex=0;
        if(stageIndex >= stages.length) return finish();
      }
      if(stageIndex >= stages.length) return finish();
      const qobj = stages[stageIndex].questions[questionIndex];
      const box = document.createElement('div');
      box.className='question-box';
      const qEl = document.createElement('div');
      qEl.className='question';
      qEl.textContent = qobj.q;
      box.appendChild(qEl);
      const opts = document.createElement('div');
      opts.className='options';
      qobj.options.forEach((opt, idx)=>{
        const btn = document.createElement('button');
        btn.className='option-btn';
        btn.textContent = opt;
        btn.disabled=false;
        btn.addEventListener('click', ()=>{
          if(answered) return;
          answered = true;
          document.querySelectorAll('.option-btn').forEach(b=>b.disabled=true);
          if(idx === qobj.correct){
            btn.classList.add('correct');
            coins += qobj.reward;
            playSuccess();
            floatCoin(qobj.reward);
          } else {
            btn.classList.add('wrong');
            const correctBtn = Array.from(document.querySelectorAll('.option-btn'))[qobj.correct];
            if(correctBtn) correctBtn.classList.add('correct');
            playFail();
          }
          setTimeout(()=>{
            questionIndex++;
            updateHeader();
            showQuestion();
          }, 800);
          updateHeader();
        });
        opts.appendChild(btn);
      });
      box.appendChild(opts);
      const fb = document.createElement('div');
      fb.className='feedback';
      box.appendChild(fb);
      const next = document.createElement('button');
      next.textContent='Next';
      next.className='next-btn';
      next.style.display='none'; // navigation auto
      box.appendChild(next);
      contentEl.appendChild(box);
      updateHeader();
    }

    function finish() {
      document.getElementById('content').style.display='none';
      const final = document.getElementById('final-screen');
      final.style.display='block';
      document.getElementById('final-coins').textContent=coins;
      // convert coins to coupon description
      const base = Math.floor(coins / 30);
      const coupons = coins > 0 ? Math.max(base,3) : 3;
      const detailEl = document.getElementById('bonus-detail');
      if(coins > 0){
        detailEl.textContent = `You earned ${coupons} coupon${coupons === 1 ? '' : 's'} of 10% off the book and have ${coins % 30} leftover coin${(coins %30) ===1?'':'s'}.`;
      } else {
        detailEl.textContent = `You didn't earn performance coupons, but you still get 3 participation bonuses.`;
      }
      // coupon code
      const code = coins > 0 ? "FAITH" + (coupons*10) + "OFF" : "FAITHPART";
      document.getElementById('coupon-code').textContent=code;
    }

    document.getElementById('restart').addEventListener('click', ()=>{
      stageIndex=0; questionIndex=0; coins=0; answered=false;
      document.getElementById('content').style.display='';
      document.getElementById('final-screen').style.display='none';
      showQuestion();
      updateHeader();
    });

    // init
    showQuestion();
    updateHeader();
  </script>
</body>
</html>
